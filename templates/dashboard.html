{{define "content"}}
<div id="endpoints">
    <button class="button" id="settings-button">[ Settings ]</button>
    <button class="button" hx-get="/endpoints/add" hx-target="#endpoints">[ Add Endpoint ]</button>
    {{range .Account.Endpoints}}
    <details>
        <summary class="button">{{.Datacenter}} | {{if .IP}}{{.IP}}{{else}}Spawning...{{end}}</summary>
        <div class="details-contents">
            <button class="button" hx-delete="/endpoints/{{.ID}}" hx-target="#endpoints">[ Delete Endpoint ]</button>
            {{range .Clients}}
                {{if .Active}}
                    <details>
                        <summary class="button">{{.ID}}</summary>
                        <div class="details-contents">
                            <pre>{{.Config}}</pre>
                            <a href="/endpoints/{{.EndpointID}}/{{.ID}}">Download</a>
                            <img src="data:image/png;base64,{{.QR}}" alt="QR Code">
                        </div>
                    </details>
                {{end}}
            {{end}}
        </div>
    </details>
    {{end}}
</div>
<dialog id="settings-dialog">
    <div id="settings" class="details-contents">
        <label class="setting">
            Digital Ocean Token:
            {{if .Account.DigitalOceanToken}}
            <input type="text" name="pin" value="{{.Account.DigitalOceanToken}}">
            <input hx-get="/token/add" hx-target="#settings" class="button" type="submit" value="[ Edit ]">
            {{else}}
            <input hx-get="/token/add" hx-target="#settings" class="button" type="submit" value="[ Add ]">
            {{end}}
        </label>
    </div>
    <button class="button" id="close-settings">[ Close ]</button>
</dialog>
<script>
    // JavaScript to handle the dialog open and close
    document.getElementById('settings-button').addEventListener('click', function() {
        document.getElementById('settings-dialog').showModal();
    });

    document.getElementById('close-settings').addEventListener('click', function() {
        document.getElementById('settings-dialog').close();
    });
</script>
{{end}}
